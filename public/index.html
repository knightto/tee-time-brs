<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <title>Tee Times</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link href="/style.css" rel="stylesheet">
</head>
<body>
  <header class="bar">
    <h1 class="title">Tee Times</h1>
    <nav style="display:flex;gap:12px;align-items:center;margin-left:auto">
      <a href="/rules.html" style="color:white;text-decoration:none;padding:8px 16px;border:1px solid rgba(255,255,255,0.3);border-radius:8px;font-weight:600;font-size:14px;transition:all 0.2s" onmouseover="this.style.background='rgba(255,255,255,0.1)'" onmouseout="this.style.background='transparent'">Weekend Game Rules</a>
      <button id="openSubscribeBtn" style="background:var(--green-600);color:white;padding:8px 16px;border:none;border-radius:8px;cursor:pointer;font-weight:600">Subscribe</button>
    </nav>
  </header>

  <!-- Subscribe Dialog -->
  <dialog id="subscribeModal">
    <form id="subscribeForm" method="dialog">
      <h3>Subscribe to Notifications</h3>
      
      <label>Email Address
        <input type="email" name="email" id="emailInput" placeholder="your@email.com" required>
      </label>

      <span id="subMsg" class="muted" style="display:block;margin:12px 0"></span>

      <menu>
        <button type="button" data-cancel>Cancel</button>
        <button type="submit" class="primary">Subscribe</button>
      </menu>
    </form>
  </dialog>

  <main class="wrap">
    <div class="main-layout">
      <!-- Left sidebar: Calendar -->
      <aside class="calendar-sidebar">
        <div class="calendar-header">
          <button id="prevMonth" class="icon" title="Previous month">â€¹</button>
          <h2 id="currentMonth">Month Year</h2>
          <button id="nextMonth" class="icon" title="Next month">â€º</button>
        </div>
        <div class="calendar-grid" id="calendarGrid"></div>
        <div class="calendar-actions">
          <button id="newTeeBtn" class="primary">New Tee-Time Event</button>
          <button id="newTeamBtn" class="primary">New Team Event</button>
        </div>
      </aside>

      <!-- Right side: Events -->
      <div class="events-container">
        <div class="events-header">
          <h2 id="selectedDateTitle">Select a date</h2>
        </div>
        <div id="events"></div>
      </div>
    </div>
  </main>

  <!-- Create Event Modal -->
  <dialog id="eventModal" style="max-width:550px;border-radius:12px;border:none;box-shadow:0 20px 25px -5px rgba(0,0,0,0.1),0 10px 10px -5px rgba(0,0,0,0.04)">
    <form id="eventForm" method="dialog">
      <h3 id="eventFormTitle" style="margin:0 0 16px 0;font-size:20px;color:#111827;display:flex;align-items:center;gap:6px">
        <span style="font-size:24px">ğŸŒï¸</span> Create Golf Event
      </h3>

      <!-- Course Selection Section -->
      <div style="background:linear-gradient(135deg,#f0fdf4 0%,#dcfce7 100%);padding:12px;border-radius:8px;margin-bottom:12px">
        <label style="display:block;margin-bottom:0">
          <span style="display:flex;align-items:center;gap:4px;font-weight:600;color:#166534;margin-bottom:6px;font-size:14px">
            <span>ğŸŒï¸</span> Golf Course
          </span>
          <input 
            type="text" 
            name="course" 
            id="courseSearch" 
            list="courseList"
            placeholder="Type to search courses..."
            required 
            autocomplete="off"
            style="width:100%;padding:8px;border:2px solid #86efac;border-radius:6px;font-size:14px;background:white">
          <datalist id="courseList">
            <option value="">Loading courses...</option>
          </datalist>
        </label>
        
        <!-- Course Info Card (hidden until course selected) -->
        <div id="courseInfoCard" style="display:none;background:white;padding:8px;border-radius:6px;margin-top:8px;border:2px solid #86efac">
          <div id="courseLocation" style="font-size:12px;color:#15803d;margin-bottom:4px"></div>
          <div id="courseDetails" style="font-size:11px;color:#166534;display:flex;flex-wrap:wrap;gap:8px"></div>
          <div id="courseWebsite" style="margin-top:4px"></div>
        </div>
      </div>

      <!-- Date Section -->
      <div style="background:linear-gradient(135deg,#eff6ff 0%,#dbeafe 100%);padding:12px;border-radius:8px;margin-bottom:12px">
        <label>
          <span style="display:flex;align-items:center;gap:4px;font-weight:600;color:#1e40af;margin-bottom:6px;font-size:14px">
            <span>ğŸ“…</span> Date
          </span>
          <input name="date" id="dateInput" type="date" required style="width:100%;padding:8px;border:2px solid #93c5fd;border-radius:6px;font-size:14px">
        </label>
        <div id="weatherPreview" style="display:none;background:white;padding:6px;border-radius:6px;margin-top:8px;border:2px solid #93c5fd;text-align:center;font-size:12px"></div>
      </div>

      <!-- Tee-time fields (shown only for Tee-Time events) -->
      <div id="teeTimeRow" style="background:linear-gradient(135deg,#fef3c7 0%,#fde68a 100%);padding:12px;border-radius:8px;margin-bottom:12px">
        <label>
          <span style="display:flex;align-items:center;gap:4px;font-weight:600;color:#92400e;margin-bottom:6px;font-size:14px">
            <span>â°</span> First Tee Time
          </span>
          <input name="teeTime" type="time" step="60" required style="width:100%;padding:8px;border:2px solid #fcd34d;border-radius:6px;font-size:14px">
        </label>
        <p style="font-size:11px;color:#78350f;margin:6px 0 0 0;font-style:italic">Creates 3 tee times, 9 minutes apart (you can add/edit more after)</p>
      </div>

      <!-- Team fields (shown only for Team events) -->
      <div id="teamSizeRow" hidden style="background:linear-gradient(135deg,#fce7f3 0%,#fbcfe8 100%);padding:12px;border-radius:8px;margin-bottom:12px">
        <label style="display:block;margin-bottom:8px">
          <span style="display:flex;align-items:center;gap:4px;font-weight:600;color:#831843;margin-bottom:6px;font-size:14px">
            <span>ğŸ‘¥</span> Team Size Max
          </span>
          <input name="teamSizeMax" type="number" min="2" max="4" value="4" style="width:100%;padding:8px;border:2px solid #f9a8d4;border-radius:6px;font-size:14px">
        </label>
        
        <label style="display:block;margin-bottom:8px">
          <span style="display:flex;align-items:center;gap:4px;font-weight:600;color:#831843;margin-bottom:6px;font-size:14px">
            <span>ğŸ</span> Start Type
          </span>
          <select name="teamStartType" id="teamStartType" style="width:100%;padding:8px;border:2px solid #f9a8d4;border-radius:6px;font-size:14px;background:white">
            <option value="shotgun">Shotgun Start (all teams start at same time)</option>
            <option value="teetimes">Tee Time Start (teams start at different times)</option>
          </select>
        </label>
        
        <div id="teamStartTimeField">
          <label>
            <span style="display:flex;align-items:center;gap:4px;font-weight:600;color:#831843;margin-bottom:6px;font-size:14px">
              <span>â°</span> Start Time
            </span>
            <input name="teamStartTime" id="teamStartTime" type="time" step="60" required style="width:100%;padding:8px;border:2px solid #f9a8d4;border-radius:6px;font-size:14px">
          </label>
          <p id="teamStartHint" style="font-size:11px;color:#831843;margin:6px 0 0 0;font-style:italic">All teams start at this time</p>
        </div>
      </div>

      <!-- Notes Section -->
      <label style="display:block;margin-bottom:12px">
        <span style="display:flex;align-items:center;gap:4px;font-weight:600;color:#475569;margin-bottom:6px;font-size:14px">
          <span>ğŸ“</span> Notes (Optional)
        </span>
        <textarea name="notes" rows="2" placeholder="Optional notes..." style="width:100%;padding:8px;border:2px solid #cbd5e1;border-radius:6px;font-size:13px;resize:vertical"></textarea>
      </label>

      <!-- internal: chosen create mode -->
      <input type="hidden" name="mode" id="createMode" value="tees">

      <menu>
        <button type="button" data-cancel>Cancel</button>
        <button type="submit" class="primary">Create</button>
      </menu>
    </form>
  </dialog>

  <!-- Edit + Move dialogs are injected by script.js -->

  <!-- Debug/Error Console Footer -->
  <footer style="position:fixed;bottom:0;left:0;right:0;background:rgba(0,0,0,0.9);color:#fff;padding:4px 12px;font-size:11px;z-index:9999;display:none;max-height:200px;overflow-y:auto;" id="debugFooter">
    <div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:4px;position:sticky;top:0;background:rgba(0,0,0,0.95);padding:4px 0;">
      <strong>Errors & Debug Info</strong>
      <button onclick="document.getElementById('debugFooter').style.display='none';document.getElementById('showLogsBtn').style.display='block'" style="background:transparent;border:1px solid #666;color:#fff;padding:2px 8px;border-radius:4px;cursor:pointer;font-size:10px;">Close</button>
    </div>
    <div id="debugLogs" style="font-family:monospace;white-space:pre-wrap;word-break:break-all;"></div>
  </footer>
  
  <button id="showLogsBtn" onclick="document.getElementById('debugFooter').style.display='block';this.style.display='none'" style="position:fixed;bottom:12px;right:12px;background:#dc2626;color:#fff;border:1px solid #991b1b;padding:6px 12px;border-radius:6px;cursor:pointer;font-size:11px;z-index:9998;box-shadow:0 2px 8px rgba(0,0,0,0.3);">Show Errors</button>

  <!-- Admin Link -->
  <div style="position:fixed;bottom:12px;left:12px;z-index:9998;">
    <a href="/admin.html" target="_blank" style="display:inline-block;background:#475569;color:#fff;padding:6px 12px;border-radius:6px;text-decoration:none;font-size:11px;box-shadow:0 2px 8px rgba(0,0,0,0.3);transition:background 0.2s;" onmouseover="this.style.background='#334155'" onmouseout="this.style.background='#475569'">âš™ï¸ Admin</a>
  </div>

  <script src="/script.js" defer></script>
</body>
</html>
